<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#3F56CE"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2024-11-01T15:34:16.7220385"><title>Authentication ViewModel (AuthViewModel.kt) | Voci App Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"overview","level":0,"title":"Overview","anchor":"#overview"},{"id":"code-explanation","level":0,"title":"Code Explanation","anchor":"#code-explanation"},{"id":"related-files","level":0,"title":"Related Files","anchor":"#related-files"},{"id":"usage","level":0,"title":"Usage","anchor":"#usage"},{"id":"additional-notes","level":0,"title":"Additional Notes","anchor":"#additional-notes"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b419/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/voci-logo.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Authentication ViewModel (AuthViewModel.kt) | Voci App Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Voci App Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/authviewmodel.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Authentication ViewModel (AuthViewModel.kt) | Voci App Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/authviewmodel.html#webpage",
    "url": "writerside-documentation/authviewmodel.html",
    "name": "Authentication ViewModel (AuthViewModel.kt) | Voci App Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Voci App Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="AuthViewModel" data-main-title="Authentication ViewModel (AuthViewModel.kt)" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="reference///app///ui///vieModels"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Voci App Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="AuthViewModel" id="AuthViewModel.md">Authentication ViewModel (AuthViewModel.kt)</h1><section class="chapter"><h2 id="overview" data-toc="overview">Overview</h2><p id="ag54ir_8">This file defines the <code class="code" id="ag54ir_9">AuthViewModel</code> class, which handles user authentication and profile management. It interacts with Firebase Authentication to perform actions such as sign-in, sign-out, user creation, and profile updates. The class utilizes Kotlin Coroutines and StateFlow to manage and observe the authentication state.</p></section><section class="chapter"><h2 id="code-explanation" data-toc="code-explanation">Code Explanation</h2><section class="chapter"><h3 id="breakdown" data-toc="breakdown">Breakdown</h3><ul class="list _bullet" id="ag54ir_12"><li class="list__item" id="ag54ir_13"><p id="ag54ir_26"><span class="control" id="ag54ir_28"><code class="code" id="ag54ir_29">class AuthViewModel : ViewModel()</code></span></p><ul class="list _bullet" id="ag54ir_27"><li class="list__item" id="ag54ir_30"><p>Inherits from <code class="code" id="ag54ir_31">ViewModel</code> to manage UI-related data in a lifecycle-conscious way.</p></li></ul></li><li class="list__item" id="ag54ir_14"><p id="ag54ir_32"><span class="control" id="ag54ir_34"><code class="code" id="ag54ir_35">private val _authState = MutableStateFlow&lt;AuthState&gt;(AuthState.Uninitialized)</code></span></p><ul class="list _bullet" id="ag54ir_33"><li class="list__item" id="ag54ir_36"><p>Holds the mutable state of the authentication status.</p></li><li class="list__item" id="ag54ir_37"><p>Initially set to <code class="code" id="ag54ir_38">Uninitialized</code>.</p></li></ul></li><li class="list__item" id="ag54ir_15"><p id="ag54ir_39"><span class="control" id="ag54ir_41"><code class="code" id="ag54ir_42">val authState: StateFlow&lt;AuthState&gt; = _authState.asStateFlow()</code></span></p><ul class="list _bullet" id="ag54ir_40"><li class="list__item" id="ag54ir_43"><p>Exposes a read-only version of <code class="code" id="ag54ir_44">_authState</code>.</p></li></ul></li><li class="list__item" id="ag54ir_16"><p id="ag54ir_45"><span class="control" id="ag54ir_47"><code class="code" id="ag54ir_48">private val auth: FirebaseAuth = FirebaseAuth.getInstance()</code></span></p><ul class="list _bullet" id="ag54ir_46"><li class="list__item" id="ag54ir_49"><p>Initializes an instance of Firebase Authentication.</p></li></ul></li><li class="list__item" id="ag54ir_17"><p id="ag54ir_50"><span class="control" id="ag54ir_52"><code class="code" id="ag54ir_53">private val authStateListener = FirebaseAuth.AuthStateListener { ... }</code></span></p><ul class="list _bullet" id="ag54ir_51"><li class="list__item" id="ag54ir_54"><p>Listener that updates the <code class="code" id="ag54ir_56">_authState</code> based on the current user authentication state.</p></li><li class="list__item" id="ag54ir_55"><p>Sets the state to <code class="code" id="ag54ir_57">Authenticated</code> if a <code class="code" id="ag54ir_58">FirebaseUser</code> is present; otherwise, sets it to <code class="code" id="ag54ir_59">Unauthenticated</code>.</p></li></ul></li><li class="list__item" id="ag54ir_18"><p id="ag54ir_60"><span class="control" id="ag54ir_62"><code class="code" id="ag54ir_63">init { ... }</code></span></p><ul class="list _bullet" id="ag54ir_61"><li class="list__item" id="ag54ir_64"><p>Adds the <code class="code" id="ag54ir_65">authStateListener</code> to Firebase Authentication when the <code class="code" id="ag54ir_66">AuthViewModel</code> is initialized.</p></li></ul></li><li class="list__item" id="ag54ir_19"><p id="ag54ir_67"><span class="control" id="ag54ir_69"><code class="code" id="ag54ir_70">override fun onCleared() { ... }</code></span></p><ul class="list _bullet" id="ag54ir_68"><li class="list__item" id="ag54ir_71"><p>Removes the <code class="code" id="ag54ir_72">authStateListener</code> when the <code class="code" id="ag54ir_73">ViewModel</code> is cleared to prevent memory leaks.</p></li></ul></li><li class="list__item" id="ag54ir_20"><p id="ag54ir_74"><span class="control" id="ag54ir_76"><code class="code" id="ag54ir_77">suspend fun signInWithEmailAndPassword(email: String, password: String): AuthResult</code></span></p><ul class="list _bullet" id="ag54ir_75"><li class="list__item" id="ag54ir_78"><p>Signs in a user with an email and password.</p></li><li class="list__item" id="ag54ir_79"><p>Returns <code class="code" id="ag54ir_80">AuthResult.Success</code> if successful or <code class="code" id="ag54ir_81">AuthResult.Failure</code> with an error message if unsuccessful.</p></li></ul></li><li class="list__item" id="ag54ir_21"><p id="ag54ir_82"><span class="control" id="ag54ir_84"><code class="code" id="ag54ir_85">suspend fun createUserWithEmailAndPassword(email: String, password: String): AuthResult</code></span></p><ul class="list _bullet" id="ag54ir_83"><li class="list__item" id="ag54ir_86"><p>Creates a new user account with an email and password.</p></li><li class="list__item" id="ag54ir_87"><p>Returns <code class="code" id="ag54ir_88">AuthResult.Success</code> if successful or <code class="code" id="ag54ir_89">AuthResult.Failure</code> with an error message if unsuccessful.</p></li></ul></li><li class="list__item" id="ag54ir_22"><p id="ag54ir_90"><span class="control" id="ag54ir_92"><code class="code" id="ag54ir_93">fun signOut()</code></span></p><ul class="list _bullet" id="ag54ir_91"><li class="list__item" id="ag54ir_94"><p>Signs out the current user.</p></li></ul></li><li class="list__item" id="ag54ir_23"><p id="ag54ir_95"><span class="control" id="ag54ir_97"><code class="code" id="ag54ir_98">suspend fun updateUserProfile(displayName: String?, photoUrl: String?): AuthResult</code></span></p><ul class="list _bullet" id="ag54ir_96"><li class="list__item" id="ag54ir_99"><p>Updates the user's profile information such as display name and profile photo.</p></li><li class="list__item" id="ag54ir_100"><p>Returns <code class="code" id="ag54ir_101">AuthResult.Success</code> if successful or <code class="code" id="ag54ir_102">AuthResult.Failure</code> with an error message if unsuccessful.</p></li></ul></li><li class="list__item" id="ag54ir_24"><p id="ag54ir_103"><span class="control" id="ag54ir_105"><code class="code" id="ag54ir_106">fun getCurrentUserProfile(): UserProfile?</code></span></p><ul class="list _bullet" id="ag54ir_104"><li class="list__item" id="ag54ir_107"><p>Retrieves the current user's profile information.</p></li><li class="list__item" id="ag54ir_108"><p>Returns a <code class="code" id="ag54ir_109">UserProfile</code> object or null if no user is logged in.</p></li></ul></li><li class="list__item" id="ag54ir_25"><p id="ag54ir_110"><span class="control" id="ag54ir_112"><code class="code" id="ag54ir_113">fun getCurrentUser(): FirebaseUser?</code></span></p><ul class="list _bullet" id="ag54ir_111"><li class="list__item" id="ag54ir_114"><p>Retrieves the currently authenticated <code class="code" id="ag54ir_115">FirebaseUser</code>.</p></li></ul></li></ul></section><section class="chapter"><h3 id="helper-classes-and-sealed-classes" data-toc="helper-classes-and-sealed-classes">Helper Classes and Sealed Classes</h3><ul class="list _bullet" id="ag54ir_116"><li class="list__item" id="ag54ir_117"><p id="ag54ir_119"><span class="control" id="ag54ir_121"><code class="code" id="ag54ir_122">sealed class AuthResult</code></span></p><ul class="list _bullet" id="ag54ir_120"><li class="list__item" id="ag54ir_123"><p>Represents the result of an authentication operation.</p></li><li class="list__item" id="ag54ir_124"><p>Contains two subclasses: <code class="code" id="ag54ir_125">Success</code> and <code class="code" id="ag54ir_126">Failure</code>.</p></li></ul></li><li class="list__item" id="ag54ir_118"><p id="ag54ir_127"><span class="control" id="ag54ir_129"><code class="code" id="ag54ir_130">data class UserProfile(val displayName: String? = null, val photoUrl: String? = null)</code></span></p><ul class="list _bullet" id="ag54ir_128"><li class="list__item" id="ag54ir_131"><p>Data class that stores user profile information such as display name and photo URL.</p></li></ul></li></ul></section></section><section class="chapter"><h2 id="related-files" data-toc="related-files">Related Files</h2><ul class="list _bullet" id="ag54ir_132"><li class="list__item" id="ag54ir_133"><p><span class="control" id="ag54ir_136"><a href="userprofilescreen.html" id="ag54ir_138" data-tooltip="This file defines the user profile screen component for the application. The screen displays the user's profile information and provides options for editing the profile and logging out. It utilizes Jetpack Compose to create a responsive and interactive UI.">UserProfileScreen.kt</a>:</span> Utilizes <code class="code" id="ag54ir_137">AuthViewModel</code> to display and manage user profile information.</p></li><li class="list__item" id="ag54ir_134"><p><span class="control" id="ag54ir_139"><a href="navgraph.html" id="ag54ir_140" data-tooltip="This file defines the navigation graph for the application, which controls the navigation flow between different screens. It uses Jetpack Compose's Navigation component to manage the navigation stack and transitions.">NavGraph.kt</a>:</span> Defines the navigation routes including those for authentication-related screens (sign-in, sign-up).</p></li><li class="list__item" id="ag54ir_135"><p><span class="control" id="ag54ir_141"><a href="mainactivity.html" id="ag54ir_143" data-tooltip="This file defines the main activity of the application, which serves as the entry point. It sets up the main UI scaffold, applies the theme, and integrates the navigation graph. The activity utilizes Jetpack Compose to define a composable layout.">MainActivity.kt</a>:</span> Sets up the main structure and integrates the <code class="code" id="ag54ir_142">AuthViewModel</code>.</p></li></ul></section><section class="chapter"><h2 id="usage" data-toc="usage">Usage</h2><p id="ag54ir_144">The <code class="code" id="ag54ir_147">AuthViewModel</code> is used to manage authentication and user profile operations within the app. Here's how it can be integrated and used:</p><section class="chapter"><h3 id="example-usage-in-composable" data-toc="example-usage-in-composable">Example Usage in Composable</h3><p id="ag54ir_148">Integrate the <code class="code" id="ag54ir_150">AuthViewModel</code> in your composable screen to access and manipulate authentication data:</p><div class="code-block" data-lang="kotlin">
@Composable
fun UserProfileScreen(navController: NavHostController, authViewModel: AuthViewModel) {
    val userProfile = authViewModel.getCurrentUserProfile()
    // UI elements to display user profile data
}
</div></section><section class="chapter"><h3 id="handling-authentication" data-toc="handling-authentication">Handling Authentication</h3><p id="ag54ir_151">The <code class="code" id="ag54ir_153">AuthViewModel</code> provides methods for sign-in, sign-out, user creation, and profile updates:</p><div class="code-block" data-lang="kotlin">
// Sign in with email and password
viewModelScope.launch {
    val result = authViewModel.signInWithEmailAndPassword(email, password)
    if (result is AuthResult.Success) {
        // Handle successful sign-in
    } else if (result is AuthResult.Failure) {
        // Handle sign-in failure
    }
}

// Sign out the current user
authViewModel.signOut()

// Update user profile
viewModelScope.launch {
    val result = authViewModel.updateUserProfile(displayName, photoUrl)
    if (result is AuthResult.Success) {
        // Handle successful profile update
    } else if (result is AuthResult.Failure) {
        // Handle profile update failure
    }
}
</div></section></section><section class="chapter"><h2 id="additional-notes" data-toc="additional-notes">Additional Notes</h2><ul class="list _bullet" id="ag54ir_154"><li class="list__item" id="ag54ir_155"><p>Using <code class="code" id="ag54ir_158">StateFlow</code> allows observing authentication state changes efficiently in a Compose UI.</p></li><li class="list__item" id="ag54ir_156"><p>Incorporates best practices for handling authentication operations with Firebase in a Kotlin-based Android app.</p></li><li class="list__item" id="ag54ir_157"><p>Proper usage and disposal of <code class="code" id="ag54ir_159">AuthStateListener</code> prevent memory leaks and ensure the application remains responsive.</p></li></ul></section><div class="last-modified">Last modified: 01 novembre 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="colors.html" class="navigation-links__prev">Color Palette</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b419/app.js"></script></body></html>